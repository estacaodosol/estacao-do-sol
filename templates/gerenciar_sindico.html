{% extends 'base.html' %}
{% block titulo %}Gerenciar Síndico{% endblock %}

{% block conteudo %}
<div class="container mt-4">

  <!-- Cabeçalho com botões -->
  <div class="d-flex justify-content-between mb-4">
    <a href="{{ url_for('index') }}" class="btn btn-secondary">Voltar para o Início</a>
    <a href="{{ url_for('logout') }}" class="btn btn-danger">Sair</a>
  </div>

  {% if not moradores %}
    <div class="alert alert-warning">
      Nenhum morador cadastrado no momento.
    </div>
  {% else %}
    <h2>Estatísticas dos Serviços</h2>
    
    <!-- Exemplo de estatística em tabela -->
    <table class="table table-bordered table-striped mb-4">
      <thead class="table-dark">
        <tr>
          <th>Serviço</th>
          <th>Total de Solicitações</th>
        </tr>
      </thead>
      <tbody>
        {% for servico, total in estatisticas.items() %}
        <tr>
          <td>{{ servico }}</td>
          <td>{{ total }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Gráfico de barras usando Chart.js -->
    <canvas id="graficoServicos" width="400" height="200"></canvas>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      const ctx = document.getElementById('graficoServicos').getContext('2d');
      const graficoServicos = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: {{ estatisticas.keys()|list }},
          datasets: [{
            label: 'Total de solicitações',
            data: {{ estatisticas.values()|list }},
            backgroundColor: 'rgba(54, 162, 235, 0.6)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    </script>
  {% endif %}
</div>
{% endblock %}
